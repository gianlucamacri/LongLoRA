
  3%|█████                                                                                                                                                   | 1/30 [00:02<01:06,  2.29s/it]
 20%|██████████████████████████████▍                                                                                                                         | 2/10 [00:00<00:02,  3.51it/s]



  File "/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py", line 389, in <module>██████████████████████████████| 10/10 [00:05<00:00,  1.50it/s]
    train()
  File "/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py", line 383, in train
    trainer.train()
  File "/home/gmacri/anaconda3/envs/LongLora/lib/python3.10/site-packages/transformers/trainer.py", line 1591, in train
    return inner_training_loop(
  File "/home/gmacri/anaconda3/envs/LongLora/lib/python3.10/site-packages/transformers/trainer.py", line 1984, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/home/gmacri/anaconda3/envs/LongLora/lib/python3.10/site-packages/transformers/trainer.py", line 2328, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/gmacri/anaconda3/envs/LongLora/lib/python3.10/site-packages/transformers/trainer.py", line 3066, in evaluate
    output = eval_loop(
  File "/home/gmacri/anaconda3/envs/LongLora/lib/python3.10/site-packages/transformers/trainer.py", line 3359, in evaluation_loop
    metrics = self.compute_metrics(EvalPrediction(predictions=all_preds, label_ids=all_labels))
  File "/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py", line 233, in <lambda>
    compute_metrics = lambda x: compute_metrics_hf(eval_pred=x, metric_fs=metric_fs)
  File "/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py", line 244, in compute_metrics_hf
    metrics.update(metric_f(predictions=outputs, references=y))
TypeError: 'Rouge' object is not callable
<transformers.trainer_utils.EvalPrediction object at 0x7f66f7051c00>
[[[ -5.1796875    1.1914062    3.3085938  ...  -4.3945312   -2.0859375
    -1.3984375 ]
  [ -4.859375     1.140625     5.3007812  ...   0.1048584   -0.8984375
    -0.89404297]
  [ -5.6054688    1.234375     6.7265625  ...  -0.2536621   -1.0839844
    -0.5229492 ]
  ...
  [ -9.4609375  -14.1171875    3.7695312  ...  -4.65625     -4.5742188
    -2.1738281 ]
  [ -8.7578125  -12.3984375    3.3300781  ...  -5.6992188   -3.7851562
    -2.3320312 ]
  [ -8.9453125   -9.65625      4.0351562  ...  -6.4023438   -3.7597656
    -2.5390625 ]]
 [[ -3.3222656   -0.7890625    1.4882812  ...  -3.7792969   -2.0976562
    -1.1240234 ]
  [ -6.5664062    2.8886719    4.1210938  ...  -2.34375     -1.6464844
    -1.6347656 ]
  [ -5.6054688    2.3867188    4.0195312  ...   0.70458984  -0.4033203
    -0.85546875]
  ...
  [-10.9140625   -9.328125     2.7578125  ...  -5.796875    -4.8359375
    -2.7109375 ]
  [-12.0234375  -10.171875    -0.10949707 ...  -9.1015625   -8.234375
    -5.8046875 ]
  [ -6.8164062   -3.1152344    5.3554688  ...  -2.8789062   -3.7675781
    -0.7910156 ]]
 [[ -5.5898438    1.4853516    3.9179688  ...  -4.6796875   -1.3837891
    -1.4833984 ]
  [ -9.          -4.265625     1.5908203  ...  -4.8710938   -3.2519531
    -5.1914062 ]
  [ -8.921875    -3.8261719    1.6113281  ...  -5.203125    -3.046875
    -5.1171875 ]
  ...
  [ -6.8476562   -9.2734375    6.0820312  ...  -6.265625    -3.3144531
    -1.7998047 ]
  [ -7.8671875   -6.5078125    2.4082031  ...  -6.2695312   -3.28125
    -3.6386719 ]
  [ -9.984375   -10.3359375    3.1699219  ...  -9.5546875   -5.734375
    -4.7695312 ]]
 ...
 [[ -4.1015625   -0.5361328    1.8408203  ...  -4.1445312   -2.0195312
    -1.2705078 ]
  [ -7.5507812   -1.0595703    2.2519531  ...  -4.6914062   -3.3808594
    -3.2011719 ]
  [ -8.7890625   -3.5664062   -0.6308594  ...  -5.375       -5.2851562
    -5.234375  ]
  ...
  [-11.96875    -11.1171875   -1.1259766  ... -11.5625      -8.7265625
    -7.1640625 ]
  [-12.5859375  -11.21875     -0.0430603  ... -10.6640625   -7.9023438
    -6.921875  ]
  [-12.265625   -13.3828125   -0.7207031  ...  -9.4609375   -7.7148438
    -6.3984375 ]]
 [[ -4.8085938    4.3320312    5.625      ...  -3.671875    -1.0439453
    -1.1347656 ]
  [ -5.6992188    4.5703125    9.1328125  ...  -3.046875    -0.67285156
    -0.67626953]
  [ -5.46875      4.0859375   11.2421875  ...  -1.7304688   -0.5649414
    -0.40722656]
  ...
  [ -8.3125       0.36499023   3.4003906  ...  -5.0585938   -3.9667969
    -3.515625  ]
  [ -7.46875      2.2070312    1.6923828  ...  -4.6445312   -3.5507812
    -3.2949219 ]
  [ -8.4375       1.1396484    5.0976562  ...  -5.1132812   -4.4414062
    -3.3828125 ]]
 [[ -3.8085938   -0.6928711    2.09375    ...  -4.234375    -1.9140625
    -1.1591797 ]
  [  8.4921875   12.109375     2.5351562  ...   3.5292969    6.671875
     3.8574219 ]
  [  0.5683594    0.36889648  -0.88916016 ...   0.69140625   1.8339844
    -1.0302734 ]
  ...
  [-14.0546875  -14.4765625   -0.1237793  ... -10.15625     -9.5390625
    -7.4726562 ]
  [-13.3828125  -13.21875      1.4082031  ...  -9.015625    -9.515625
    -7.0039062 ]
  [-10.8984375  -13.2421875   -0.3317871  ...  -8.125       -8.8359375
    -5.6679688 ]]]