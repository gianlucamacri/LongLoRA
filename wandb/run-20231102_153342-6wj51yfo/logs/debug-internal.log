2023-11-02 15:33:42,966 INFO    StreamThr :2478526 [internal.py:wandb_internal():86] W&B internal server running at pid: 2478526, started at: 2023-11-02 15:33:42.965563
2023-11-02 15:33:42,970 DEBUG   HandlerThread:2478526 [handler.py:handle_request():146] handle_request: status
2023-11-02 15:33:42,972 INFO    WriterThread:2478526 [datastore.py:open_for_write():85] open: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/run-6wj51yfo.wandb
2023-11-02 15:33:42,974 DEBUG   SenderThread:2478526 [sender.py:send():380] send: header
2023-11-02 15:33:42,975 DEBUG   SenderThread:2478526 [sender.py:send():380] send: run
2023-11-02 15:33:43,453 INFO    SenderThread:2478526 [dir_watcher.py:__init__():211] watching files in: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/files
2023-11-02 15:33:43,453 INFO    SenderThread:2478526 [sender.py:_start_run_threads():1122] run started: 6wj51yfo with start time 1698939222.965228
2023-11-02 15:33:43,462 DEBUG   HandlerThread:2478526 [handler.py:handle_request():146] handle_request: check_version
2023-11-02 15:33:43,462 DEBUG   SenderThread:2478526 [sender.py:send_request():407] send_request: check_version
2023-11-02 15:33:43,592 DEBUG   HandlerThread:2478526 [handler.py:handle_request():146] handle_request: run_start
2023-11-02 15:33:43,626 DEBUG   HandlerThread:2478526 [system_info.py:__init__():32] System info init
2023-11-02 15:33:43,626 DEBUG   HandlerThread:2478526 [system_info.py:__init__():47] System info init done
2023-11-02 15:33:43,626 INFO    HandlerThread:2478526 [system_monitor.py:start():194] Starting system monitor
2023-11-02 15:33:43,626 INFO    SystemMonitor:2478526 [system_monitor.py:_start():158] Starting system asset monitoring threads
2023-11-02 15:33:43,627 INFO    HandlerThread:2478526 [system_monitor.py:probe():214] Collecting system info
2023-11-02 15:33:43,628 INFO    SystemMonitor:2478526 [interfaces.py:start():190] Started cpu monitoring
2023-11-02 15:33:43,628 INFO    SystemMonitor:2478526 [interfaces.py:start():190] Started disk monitoring
2023-11-02 15:33:43,629 INFO    SystemMonitor:2478526 [interfaces.py:start():190] Started gpu monitoring
2023-11-02 15:33:43,630 INFO    SystemMonitor:2478526 [interfaces.py:start():190] Started memory monitoring
2023-11-02 15:33:43,631 INFO    SystemMonitor:2478526 [interfaces.py:start():190] Started network monitoring
2023-11-02 15:33:43,680 DEBUG   HandlerThread:2478526 [system_info.py:probe():196] Probing system
2023-11-02 15:33:43,683 DEBUG   HandlerThread:2478526 [system_info.py:_probe_git():181] Probing git
2023-11-02 15:33:43,691 DEBUG   HandlerThread:2478526 [system_info.py:_probe_git():189] Probing git done
2023-11-02 15:33:43,691 DEBUG   HandlerThread:2478526 [system_info.py:probe():244] Probing system done
2023-11-02 15:33:43,691 DEBUG   HandlerThread:2478526 [system_monitor.py:probe():223] {'os': 'Linux-5.4.0-164-generic-x86_64-with-glibc2.31', 'python': '3.11.5', 'heartbeatAt': '2023-11-02T15:33:43.680808', 'startedAt': '2023-11-02T15:33:42.959767', 'docker': None, 'cuda': None, 'args': ('--model_name_or_path', 'Yukang/LongAlpaca-13B', '--output_dir', '../../output/hdd_output/LongLoRA/test_els_13', '--model_max_length', '8192', '--use_flash_attn', 'True', '--low_rank_training', 'True', '--num_train_epochs', '40', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '2', '--per_device_eval_batch_size', '1', '--load_best_model_at_end', 'True', '--evaluation_strategy', 'epoch', '--save_strategy', 'epoch', '--save_total_limit', '7', '--learning_rate', '2e-5', '--weight_decay', '0.0', '--logging_steps', '1', '--bf16', 'True', '--tf32', 'True', '--lr_scheduler_type', 'constant', '--deepspeed', 'ds_configs/stage2.json', '--hf_dataset', 'gianma/eurlexsum_ita_cleaned_8192_232', '--target_column', 'summary', '--max_prompt_token_count', '232', '--use_early_stopping', 'True', '--es_patience', '2', '--es_threshold', '0.05', '--use_quantization', 'False', '--prompts', "Di seguito c'Ã¨ un documento legislativo in italiano. Memorizza il documento legislativo, poi segui le istruzioni.\\nINIZIO DOCUMENTO.\\n{reference}\\nFINE DOCUMENTO.\\nScrivi un dossier riassuntivo del documento. Scrivi in italiano, non scrivere in inglese.", '--system_prompt', 'You are a helpful, respectful and honest assistant specialized in writing dossiers for legislative documents. Always answer as helpfully as possible, while being safe. Your answers should not include any false information with respect to the original document.'), 'state': 'running', 'program': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py', 'codePathLocal': 'supervised-fine-tune-qlora.py', 'codePath': 'supervised-fine-tune-qlora.py', 'git': {'remote': 'git@github.com:gianlucamacri/LongLoRA.git', 'commit': '85b8f903517c7c114a154a619bcd5d8ed631375e'}, 'email': 'gianluca18ma@gmail.com', 'root': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA', 'host': 'donatello', 'username': 'gmacri', 'executable': '/home/gmacri/miniconda3/bin/python', 'cpu_count': 96, 'cpu_count_logical': 192, 'cpu_freq': {'current': 1.681250000000001, 'min': 1500.0, 'max': 2300.0}, 'cpu_freq_per_core': [{'current': 2.026, 'min': 1500.0, 'max': 2300.0}, {'current': 1.99, 'min': 1500.0, 'max': 2300.0}, {'current': 1.988, 'min': 1500.0, 'max': 2300.0}, {'current': 1.991, 'min': 1500.0, 'max': 2300.0}, {'current': 3.522, 'min': 1500.0, 'max': 2300.0}, {'current': 1.995, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.451, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.791, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.478, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.489, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.373, 'min': 1500.0, 'max': 2300.0}, {'current': 1.373, 'min': 1500.0, 'max': 2300.0}, {'current': 1.373, 'min': 1500.0, 'max': 2300.0}, {'current': 1.371, 'min': 1500.0, 'max': 2300.0}, {'current': 1.37, 'min': 1500.0, 'max': 2300.0}, {'current': 1.372, 'min': 1500.0, 'max': 2300.0}, {'current': 1.374, 'min': 1500.0, 'max': 2300.0}, {'current': 1.385, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.489, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 2.007, 'min': 1500.0, 'max': 2300.0}, {'current': 1.976, 'min': 1500.0, 'max': 2300.0}, {'current': 2.195, 'min': 1500.0, 'max': 2300.0}, {'current': 1.97, 'min': 1500.0, 'max': 2300.0}, {'current': 1.972, 'min': 1500.0, 'max': 2300.0}, {'current': 1.961, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.409, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.493, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.758, 'min': 1500.0, 'max': 2300.0}, {'current': 3.546, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.798, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.853, 'min': 1500.0, 'max': 2300.0}, {'current': 1.695, 'min': 1500.0, 'max': 2300.0}, {'current': 1.737, 'min': 1500.0, 'max': 2300.0}, {'current': 2.035, 'min': 1500.0, 'max': 2300.0}, {'current': 1.695, 'min': 1500.0, 'max': 2300.0}, {'current': 1.73, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.734, 'min': 1500.0, 'max': 2300.0}, {'current': 2.751, 'min': 1500.0, 'max': 2300.0}, {'current': 2.758, 'min': 1500.0, 'max': 2300.0}, {'current': 3.446, 'min': 1500.0, 'max': 2300.0}, {'current': 2.819, 'min': 1500.0, 'max': 2300.0}, {'current': 2.828, 'min': 1500.0, 'max': 2300.0}, {'current': 2.826, 'min': 1500.0, 'max': 2300.0}, {'current': 2.828, 'min': 1500.0, 'max': 2300.0}, {'current': 3.561, 'min': 1500.0, 'max': 2300.0}, {'current': 2.829, 'min': 1500.0, 'max': 2300.0}, {'current': 1.491, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 2.403, 'min': 1500.0, 'max': 2300.0}, {'current': 1.808, 'min': 1500.0, 'max': 2300.0}, {'current': 1.735, 'min': 1500.0, 'max': 2300.0}, {'current': 1.38, 'min': 1500.0, 'max': 2300.0}, {'current': 1.386, 'min': 1500.0, 'max': 2300.0}, {'current': 1.381, 'min': 1500.0, 'max': 2300.0}, {'current': 1.375, 'min': 1500.0, 'max': 2300.0}, {'current': 1.378, 'min': 1500.0, 'max': 2300.0}, {'current': 1.387, 'min': 1500.0, 'max': 2300.0}, {'current': 1.401, 'min': 1500.0, 'max': 2300.0}, {'current': 1.486, 'min': 1500.0, 'max': 2300.0}, {'current': 1.379, 'min': 1500.0, 'max': 2300.0}, {'current': 1.492, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.377, 'min': 1500.0, 'max': 2300.0}, {'current': 1.457, 'min': 1500.0, 'max': 2300.0}, {'current': 1.462, 'min': 1500.0, 'max': 2300.0}, {'current': 1.459, 'min': 1500.0, 'max': 2300.0}, {'current': 1.459, 'min': 1500.0, 'max': 2300.0}, {'current': 1.484, 'min': 1500.0, 'max': 2300.0}, {'current': 1.379, 'min': 1500.0, 'max': 2300.0}, {'current': 1.355, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 2.822, 'min': 1500.0, 'max': 2300.0}, {'current': 2.797, 'min': 1500.0, 'max': 2300.0}, {'current': 3.559, 'min': 1500.0, 'max': 2300.0}, {'current': 2.822, 'min': 1500.0, 'max': 2300.0}, {'current': 2.825, 'min': 1500.0, 'max': 2300.0}, {'current': 2.894, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.434, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.758, 'min': 1500.0, 'max': 2300.0}, {'current': 3.455, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.75, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.522, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.691, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.255, 'min': 1500.0, 'max': 2300.0}, {'current': 2.357, 'min': 1500.0, 'max': 2300.0}, {'current': 2.751, 'min': 1500.0, 'max': 2300.0}, {'current': 2.753, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.758, 'min': 1500.0, 'max': 2300.0}, {'current': 3.556, 'min': 1500.0, 'max': 2300.0}], 'disk': {'/': {'total': 199.90234375, 'used': 65.88386535644531}}, 'gpu': 'NVIDIA A100 80GB PCIe', 'gpu_count': 3, 'gpu_devices': [{'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}], 'memory': {'total': 2003.8960762023926}}
2023-11-02 15:33:43,692 INFO    HandlerThread:2478526 [system_monitor.py:probe():224] Finished collecting system info
2023-11-02 15:33:43,692 INFO    HandlerThread:2478526 [system_monitor.py:probe():227] Publishing system info
2023-11-02 15:33:43,692 DEBUG   HandlerThread:2478526 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2023-11-02 15:33:43,692 DEBUG   HandlerThread:2478526 [system_info.py:_save_pip():68] Saving pip packages done
2023-11-02 15:33:43,692 DEBUG   HandlerThread:2478526 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2023-11-02 15:33:44,455 INFO    Thread-12 :2478526 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/files/conda-environment.yaml
2023-11-02 15:33:44,455 INFO    Thread-12 :2478526 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/files/requirements.txt
2023-11-02 15:33:45,637 INFO    cpu       :2478526 [interfaces.py:monitor():140] Process cpu has exited.
2023-11-02 15:33:45,638 DEBUG   SystemMonitor:2478526 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2023-11-02 15:33:45,638 DEBUG   SystemMonitor:2478526 [system_monitor.py:_start():179] Finished system metrics aggregation loop
2023-11-02 15:33:45,638 DEBUG   SystemMonitor:2478526 [system_monitor.py:_start():183] Publishing last batch of metrics
2023-11-02 15:33:45,641 INFO    memory    :2478526 [interfaces.py:monitor():140] Process proc.memory.rssMB has exited.
2023-11-02 15:33:46,973 DEBUG   HandlerThread:2478526 [system_info.py:_save_conda():87] Saving conda packages done
2023-11-02 15:33:46,975 INFO    HandlerThread:2478526 [system_monitor.py:probe():229] Finished publishing system info
2023-11-02 15:33:46,978 DEBUG   SenderThread:2478526 [sender.py:send():380] send: stats
2023-11-02 15:33:46,979 DEBUG   SenderThread:2478526 [sender.py:send():380] send: files
2023-11-02 15:33:46,979 INFO    SenderThread:2478526 [sender.py:_save_file():1378] saving file wandb-metadata.json with policy now
2023-11-02 15:33:47,455 INFO    Thread-12 :2478526 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/files/conda-environment.yaml
2023-11-02 15:33:47,455 INFO    Thread-12 :2478526 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_153342-6wj51yfo/files/wandb-metadata.json
2023-11-02 15:33:47,632 INFO    wandb-upload_0:2478526 [upload_job.py:push():131] Uploaded file /tmp/tmpryy9in6cwandb/qwcvreak-wandb-metadata.json
2023-11-02 15:33:47,633 INFO    MainThread:2478526 [internal.py:handle_exit():76] Internal process exited
