2023-11-02 20:49:23,811 INFO    StreamThr :2601069 [internal.py:wandb_internal():86] W&B internal server running at pid: 2601069, started at: 2023-11-02 20:49:23.810993
2023-11-02 20:49:23,815 DEBUG   HandlerThread:2601069 [handler.py:handle_request():146] handle_request: status
2023-11-02 20:49:23,818 INFO    WriterThread:2601069 [datastore.py:open_for_write():85] open: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_204923-8tstl3n1/run-8tstl3n1.wandb
2023-11-02 20:49:23,820 DEBUG   SenderThread:2601069 [sender.py:send():380] send: header
2023-11-02 20:49:23,820 DEBUG   SenderThread:2601069 [sender.py:send():380] send: run
2023-11-02 20:49:24,305 INFO    SenderThread:2601069 [dir_watcher.py:__init__():211] watching files in: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_204923-8tstl3n1/files
2023-11-02 20:49:24,305 INFO    SenderThread:2601069 [sender.py:_start_run_threads():1122] run started: 8tstl3n1 with start time 1698958163.810506
2023-11-02 20:49:24,313 DEBUG   HandlerThread:2601069 [handler.py:handle_request():146] handle_request: check_version
2023-11-02 20:49:24,314 DEBUG   SenderThread:2601069 [sender.py:send_request():407] send_request: check_version
2023-11-02 20:49:24,441 DEBUG   HandlerThread:2601069 [handler.py:handle_request():146] handle_request: run_start
2023-11-02 20:49:24,750 DEBUG   HandlerThread:2601069 [system_info.py:__init__():32] System info init
2023-11-02 20:49:24,750 DEBUG   HandlerThread:2601069 [system_info.py:__init__():47] System info init done
2023-11-02 20:49:24,750 INFO    HandlerThread:2601069 [system_monitor.py:start():194] Starting system monitor
2023-11-02 20:49:24,750 INFO    SystemMonitor:2601069 [system_monitor.py:_start():158] Starting system asset monitoring threads
2023-11-02 20:49:24,751 INFO    HandlerThread:2601069 [system_monitor.py:probe():214] Collecting system info
2023-11-02 20:49:24,752 INFO    SystemMonitor:2601069 [interfaces.py:start():190] Started cpu monitoring
2023-11-02 20:49:24,752 INFO    SystemMonitor:2601069 [interfaces.py:start():190] Started disk monitoring
2023-11-02 20:49:24,753 INFO    SystemMonitor:2601069 [interfaces.py:start():190] Started gpu monitoring
2023-11-02 20:49:24,754 INFO    SystemMonitor:2601069 [interfaces.py:start():190] Started memory monitoring
2023-11-02 20:49:24,756 INFO    SystemMonitor:2601069 [interfaces.py:start():190] Started network monitoring
2023-11-02 20:49:25,442 DEBUG   HandlerThread:2601069 [system_info.py:probe():196] Probing system
2023-11-02 20:49:25,444 DEBUG   HandlerThread:2601069 [system_info.py:_probe_git():181] Probing git
2023-11-02 20:49:25,453 DEBUG   HandlerThread:2601069 [system_info.py:_probe_git():189] Probing git done
2023-11-02 20:49:25,453 DEBUG   HandlerThread:2601069 [system_info.py:probe():244] Probing system done
2023-11-02 20:49:25,453 DEBUG   HandlerThread:2601069 [system_monitor.py:probe():223] {'os': 'Linux-5.4.0-164-generic-x86_64-with-glibc2.31', 'python': '3.11.5', 'heartbeatAt': '2023-11-02T20:49:25.442233', 'startedAt': '2023-11-02T20:49:23.805226', 'docker': None, 'cuda': None, 'args': ('--model_name_or_path', 'Yukang/LongAlpaca-13B', '--output_dir', '../../output/hdd_output/LongLoRA/eurlexsum_ita_13', '--model_max_length', '8192', '--use_flash_attn', 'True', '--low_rank_training', 'True', '--num_train_epochs', '30', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '4', '--per_device_eval_batch_size', '1', '--load_best_model_at_end', 'True', '--evaluation_strategy', 'epoch', '--save_strategy', 'epoch', '--save_total_limit', '7', '--learning_rate', '2e-5', '--weight_decay', '0.0', '--logging_steps', '1', '--bf16', 'True', '--tf32', 'True', '--lr_scheduler_type', 'constant', '--deepspeed', 'ds_configs/stage2.json', '--hf_dataset', 'gianma/eurlexsum_ita_cleaned_8192_232', '--target_column', 'summary', '--max_prompt_token_count', '232', '--use_early_stopping', 'True', '--es_patience', '2', '--es_threshold', '0.05', '--use_quantization', 'False', '--prompts', "Di seguito c'Ã¨ un documento legislativo in italiano. Memorizza il documento legislativo, poi segui le istruzioni.\\nINIZIO DOCUMENTO.\\n{reference}\\nFINE DOCUMENTO.\\nScrivi un dossier riassuntivo del documento. Scrivi in italiano, non scrivere in inglese.", '--system_prompt', 'You are a helpful, respectful and honest assistant specialized in writing dossiers for legislative documents. Always answer as helpfully as possible, while being safe. Your answers should not include any false information with respect to the original document.'), 'state': 'running', 'program': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py', 'codePathLocal': 'supervised-fine-tune-qlora.py', 'codePath': 'supervised-fine-tune-qlora.py', 'git': {'remote': 'git@github.com:gianlucamacri/LongLoRA.git', 'commit': '34dc73110b7a52b7e97a5ab171e1df811eb4841a'}, 'email': 'gianluca18ma@gmail.com', 'root': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA', 'host': 'donatello', 'username': 'gmacri', 'executable': '/home/gmacri/miniconda3/bin/python', 'cpu_count': 96, 'cpu_count_logical': 192, 'cpu_freq': {'current': 1.5362708333333333, 'min': 1500.0, 'max': 2300.0}, 'cpu_freq_per_core': [{'current': 2.039, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.734, 'min': 1500.0, 'max': 2300.0}, {'current': 1.732, 'min': 1500.0, 'max': 2300.0}, {'current': 1.896, 'min': 1500.0, 'max': 2300.0}, {'current': 1.599, 'min': 1500.0, 'max': 2300.0}, {'current': 1.714, 'min': 1500.0, 'max': 2300.0}, {'current': 1.599, 'min': 1500.0, 'max': 2300.0}, {'current': 1.372, 'min': 1500.0, 'max': 2300.0}, {'current': 1.367, 'min': 1500.0, 'max': 2300.0}, {'current': 1.379, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.683, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.509, 'min': 1500.0, 'max': 2300.0}, {'current': 1.389, 'min': 1500.0, 'max': 2300.0}, {'current': 1.374, 'min': 1500.0, 'max': 2300.0}, {'current': 1.377, 'min': 1500.0, 'max': 2300.0}, {'current': 1.379, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.484, 'min': 1500.0, 'max': 2300.0}, {'current': 1.797, 'min': 1500.0, 'max': 2300.0}, {'current': 1.362, 'min': 1500.0, 'max': 2300.0}, {'current': 1.363, 'min': 1500.0, 'max': 2300.0}, {'current': 1.364, 'min': 1500.0, 'max': 2300.0}, {'current': 1.366, 'min': 1500.0, 'max': 2300.0}, {'current': 1.36, 'min': 1500.0, 'max': 2300.0}, {'current': 1.352, 'min': 1500.0, 'max': 2300.0}, {'current': 1.36, 'min': 1500.0, 'max': 2300.0}, {'current': 1.354, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.999, 'min': 1500.0, 'max': 2300.0}, {'current': 1.992, 'min': 1500.0, 'max': 2300.0}, {'current': 2.403, 'min': 1500.0, 'max': 2300.0}, {'current': 2.025, 'min': 1500.0, 'max': 2300.0}, {'current': 1.99, 'min': 1500.0, 'max': 2300.0}, {'current': 2.107, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 3.484, 'min': 1500.0, 'max': 2300.0}, {'current': 2.853, 'min': 1500.0, 'max': 2300.0}, {'current': 2.745, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.79, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.483, 'min': 1500.0, 'max': 2300.0}, {'current': 1.536, 'min': 1500.0, 'max': 2300.0}, {'current': 1.527, 'min': 1500.0, 'max': 2300.0}, {'current': 1.501, 'min': 1500.0, 'max': 2300.0}, {'current': 1.533, 'min': 1500.0, 'max': 2300.0}, {'current': 1.525, 'min': 1500.0, 'max': 2300.0}, {'current': 1.526, 'min': 1500.0, 'max': 2300.0}, {'current': 1.663, 'min': 1500.0, 'max': 2300.0}, {'current': 1.54, 'min': 1500.0, 'max': 2300.0}, {'current': 1.54, 'min': 1500.0, 'max': 2300.0}, {'current': 1.54, 'min': 1500.0, 'max': 2300.0}, {'current': 1.54, 'min': 1500.0, 'max': 2300.0}, {'current': 1.539, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.871, 'min': 1500.0, 'max': 2300.0}, {'current': 1.849, 'min': 1500.0, 'max': 2300.0}, {'current': 2.363, 'min': 1500.0, 'max': 2300.0}, {'current': 1.93, 'min': 1500.0, 'max': 2300.0}, {'current': 1.735, 'min': 1500.0, 'max': 2300.0}, {'current': 1.625, 'min': 1500.0, 'max': 2300.0}, {'current': 1.443, 'min': 1500.0, 'max': 2300.0}, {'current': 1.333, 'min': 1500.0, 'max': 2300.0}, {'current': 1.607, 'min': 1500.0, 'max': 2300.0}, {'current': 1.335, 'min': 1500.0, 'max': 2300.0}, {'current': 1.335, 'min': 1500.0, 'max': 2300.0}, {'current': 1.335, 'min': 1500.0, 'max': 2300.0}, {'current': 1.374, 'min': 1500.0, 'max': 2300.0}, {'current': 1.403, 'min': 1500.0, 'max': 2300.0}, {'current': 1.403, 'min': 1500.0, 'max': 2300.0}, {'current': 1.381, 'min': 1500.0, 'max': 2300.0}, {'current': 1.389, 'min': 1500.0, 'max': 2300.0}, {'current': 1.406, 'min': 1500.0, 'max': 2300.0}, {'current': 1.38, 'min': 1500.0, 'max': 2300.0}, {'current': 1.452, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.443, 'min': 1500.0, 'max': 2300.0}, {'current': 1.393, 'min': 1500.0, 'max': 2300.0}, {'current': 1.382, 'min': 1500.0, 'max': 2300.0}, {'current': 1.404, 'min': 1500.0, 'max': 2300.0}, {'current': 1.378, 'min': 1500.0, 'max': 2300.0}, {'current': 1.261, 'min': 1500.0, 'max': 2300.0}, {'current': 1.263, 'min': 1500.0, 'max': 2300.0}, {'current': 1.348, 'min': 1500.0, 'max': 2300.0}, {'current': 1.344, 'min': 1500.0, 'max': 2300.0}, {'current': 1.337, 'min': 1500.0, 'max': 2300.0}, {'current': 1.356, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.361, 'min': 1500.0, 'max': 2300.0}, {'current': 1.359, 'min': 1500.0, 'max': 2300.0}, {'current': 1.644, 'min': 1500.0, 'max': 2300.0}, {'current': 1.36, 'min': 1500.0, 'max': 2300.0}, {'current': 1.35, 'min': 1500.0, 'max': 2300.0}, {'current': 1.364, 'min': 1500.0, 'max': 2300.0}, {'current': 1.353, 'min': 1500.0, 'max': 2300.0}, {'current': 1.36, 'min': 1500.0, 'max': 2300.0}, {'current': 1.347, 'min': 1500.0, 'max': 2300.0}, {'current': 1.346, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 2.006, 'min': 1500.0, 'max': 2300.0}, {'current': 1.997, 'min': 1500.0, 'max': 2300.0}, {'current': 3.494, 'min': 1500.0, 'max': 2300.0}, {'current': 2.702, 'min': 1500.0, 'max': 2300.0}, {'current': 2.366, 'min': 1500.0, 'max': 2300.0}, {'current': 2.116, 'min': 1500.0, 'max': 2300.0}, {'current': 2.818, 'min': 1500.0, 'max': 2300.0}, {'current': 2.812, 'min': 1500.0, 'max': 2300.0}, {'current': 3.529, 'min': 1500.0, 'max': 2300.0}, {'current': 2.853, 'min': 1500.0, 'max': 2300.0}, {'current': 2.815, 'min': 1500.0, 'max': 2300.0}, {'current': 2.831, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.789, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.532, 'min': 1500.0, 'max': 2300.0}, {'current': 1.512, 'min': 1500.0, 'max': 2300.0}, {'current': 1.671, 'min': 1500.0, 'max': 2300.0}, {'current': 1.534, 'min': 1500.0, 'max': 2300.0}, {'current': 1.531, 'min': 1500.0, 'max': 2300.0}, {'current': 1.543, 'min': 1500.0, 'max': 2300.0}, {'current': 1.492, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.501, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}], 'disk': {'/': {'total': 199.90234375, 'used': 65.88404083251953}}, 'gpu': 'NVIDIA A100 80GB PCIe', 'gpu_count': 3, 'gpu_devices': [{'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}], 'memory': {'total': 2003.8960762023926}}
2023-11-02 20:49:25,454 INFO    HandlerThread:2601069 [system_monitor.py:probe():224] Finished collecting system info
2023-11-02 20:49:25,454 INFO    HandlerThread:2601069 [system_monitor.py:probe():227] Publishing system info
2023-11-02 20:49:25,454 DEBUG   HandlerThread:2601069 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2023-11-02 20:49:25,454 DEBUG   HandlerThread:2601069 [system_info.py:_save_pip():68] Saving pip packages done
2023-11-02 20:49:25,454 DEBUG   HandlerThread:2601069 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2023-11-02 20:49:26,307 INFO    Thread-12 :2601069 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_204923-8tstl3n1/files/requirements.txt
2023-11-02 20:49:26,308 INFO    Thread-12 :2601069 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231102_204923-8tstl3n1/files/conda-environment.yaml
2023-11-02 20:49:26,759 INFO    memory    :2601069 [interfaces.py:monitor():140] Process proc.memory.rssMB has exited.
2023-11-02 20:49:26,761 DEBUG   SystemMonitor:2601069 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2023-11-02 20:49:26,761 DEBUG   SystemMonitor:2601069 [system_monitor.py:_start():179] Finished system metrics aggregation loop
2023-11-02 20:49:26,761 DEBUG   SystemMonitor:2601069 [system_monitor.py:_start():183] Publishing last batch of metrics
2023-11-02 20:49:28,442 INFO    MainThread:2601069 [internal.py:handle_exit():76] Internal process exited
