2023-11-07 17:06:13,356 INFO    StreamThr :377096 [internal.py:wandb_internal():86] W&B internal server running at pid: 377096, started at: 2023-11-07 17:06:13.355493
2023-11-07 17:06:13,357 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: status
2023-11-07 17:06:13,360 INFO    WriterThread:377096 [datastore.py:open_for_write():85] open: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/run-4kqyl9ik.wandb
2023-11-07 17:06:13,360 DEBUG   SenderThread:377096 [sender.py:send():380] send: header
2023-11-07 17:06:13,364 DEBUG   SenderThread:377096 [sender.py:send():380] send: run
2023-11-07 17:06:13,765 INFO    SenderThread:377096 [dir_watcher.py:__init__():211] watching files in: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files
2023-11-07 17:06:13,766 INFO    SenderThread:377096 [sender.py:_start_run_threads():1122] run started: 4kqyl9ik with start time 1699376773.355382
2023-11-07 17:06:13,769 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: check_version
2023-11-07 17:06:13,769 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: check_version
2023-11-07 17:06:13,871 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: run_start
2023-11-07 17:06:13,902 DEBUG   HandlerThread:377096 [system_info.py:__init__():32] System info init
2023-11-07 17:06:13,902 DEBUG   HandlerThread:377096 [system_info.py:__init__():47] System info init done
2023-11-07 17:06:13,902 INFO    HandlerThread:377096 [system_monitor.py:start():194] Starting system monitor
2023-11-07 17:06:13,902 INFO    SystemMonitor:377096 [system_monitor.py:_start():158] Starting system asset monitoring threads
2023-11-07 17:06:13,903 INFO    HandlerThread:377096 [system_monitor.py:probe():214] Collecting system info
2023-11-07 17:06:13,904 INFO    SystemMonitor:377096 [interfaces.py:start():190] Started cpu monitoring
2023-11-07 17:06:13,904 INFO    SystemMonitor:377096 [interfaces.py:start():190] Started disk monitoring
2023-11-07 17:06:13,905 INFO    SystemMonitor:377096 [interfaces.py:start():190] Started gpu monitoring
2023-11-07 17:06:13,906 INFO    SystemMonitor:377096 [interfaces.py:start():190] Started memory monitoring
2023-11-07 17:06:13,906 INFO    SystemMonitor:377096 [interfaces.py:start():190] Started network monitoring
2023-11-07 17:06:13,962 DEBUG   HandlerThread:377096 [system_info.py:probe():196] Probing system
2023-11-07 17:06:13,964 DEBUG   HandlerThread:377096 [system_info.py:_probe_git():181] Probing git
2023-11-07 17:06:13,971 DEBUG   HandlerThread:377096 [system_info.py:_probe_git():189] Probing git done
2023-11-07 17:06:13,971 DEBUG   HandlerThread:377096 [system_info.py:probe():244] Probing system done
2023-11-07 17:06:13,971 DEBUG   HandlerThread:377096 [system_monitor.py:probe():223] {'os': 'Linux-5.4.0-166-generic-x86_64-with-glibc2.31', 'python': '3.11.5', 'heartbeatAt': '2023-11-07T17:06:13.962710', 'startedAt': '2023-11-07T17:06:13.350434', 'docker': None, 'cuda': None, 'args': ('--model_name_or_path', 'Yukang/LongAlpaca-7B', '--output_dir', '../../output/hdd_output/LongLoRA/test', '--model_max_length', '8192', '--use_flash_attn', 'True', '--low_rank_training', 'True', '--num_train_epochs', '30', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '4', '--per_device_eval_batch_size', '1', '--load_best_model_at_end', 'True', '--evaluation_strategy', 'epoch', '--save_strategy', 'epoch', '--save_total_limit', '7', '--learning_rate', '2e-5', '--weight_decay', '0.0', '--logging_steps', '1', '--bf16', 'True', '--tf32', 'True', '--lr_scheduler_type', 'constant', '--deepspeed', 'ds_configs/stage2.json', '--hf_dataset', 'gianma/eurlexsum_ita_cleaned_8192_232', '--target_column', 'summary', '--max_prompt_token_count', '232', '--use_early_stopping', 'True', '--es_patience', '2', '--es_threshold', '0.05', '--use_quantization', 'True', '--prompts', "Di seguito c'Ã¨ un documento legislativo in italiano. Memorizza il documento legislativo, poi segui le istruzioni.\\nINIZIO DOCUMENTO.\\n{reference}\\nFINE DOCUMENTO.\\nScrivi un dossier riassuntivo del documento. Scrivi in italiano, non scrivere in inglese.", '--system_prompt', 'You are a helpful, respectful and honest assistant specialized in writing dossiers for legislative documents. Always answer as helpfully as possible, while being safe. Your answers should not include any false information with respect to the original document.'), 'state': 'running', 'program': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py', 'codePathLocal': 'supervised-fine-tune-qlora.py', 'codePath': 'supervised-fine-tune-qlora.py', 'git': {'remote': 'git@github.com:gianlucamacri/LongLoRA.git', 'commit': '098a4a94a3c16583a950a240563be196647fab42'}, 'email': 'gianluca18ma@gmail.com', 'root': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA', 'host': 'donatello', 'username': 'gmacri', 'executable': '/home/gmacri/miniconda3/bin/python', 'cpu_count': 96, 'cpu_count_logical': 192, 'cpu_freq': {'current': 2.0660260416666665, 'min': 1500.0, 'max': 2300.0}, 'cpu_freq_per_core': [{'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.751, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 3.578, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 3.574, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.748, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.493, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.799, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 2.825, 'min': 1500.0, 'max': 2300.0}, {'current': 3.55, 'min': 1500.0, 'max': 2300.0}, {'current': 2.807, 'min': 1500.0, 'max': 2300.0}, {'current': 2.815, 'min': 1500.0, 'max': 2300.0}, {'current': 2.813, 'min': 1500.0, 'max': 2300.0}, {'current': 2.815, 'min': 1500.0, 'max': 2300.0}, {'current': 3.525, 'min': 1500.0, 'max': 2300.0}, {'current': 2.825, 'min': 1500.0, 'max': 2300.0}, {'current': 2.821, 'min': 1500.0, 'max': 2300.0}, {'current': 2.811, 'min': 1500.0, 'max': 2300.0}, {'current': 2.788, 'min': 1500.0, 'max': 2300.0}, {'current': 2.558, 'min': 1500.0, 'max': 2300.0}, {'current': 3.554, 'min': 1500.0, 'max': 2300.0}, {'current': 2.758, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 3.418, 'min': 1500.0, 'max': 2300.0}, {'current': 2.749, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 1.797, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.79, 'min': 1500.0, 'max': 2300.0}, {'current': 1.49, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.753, 'min': 1500.0, 'max': 2300.0}, {'current': 2.745, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 3.556, 'min': 1500.0, 'max': 2300.0}, {'current': 1.492, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 1.506, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 2.751, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 3.557, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.733, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.531, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 2.828, 'min': 1500.0, 'max': 2300.0}, {'current': 2.842, 'min': 1500.0, 'max': 2300.0}, {'current': 2.83, 'min': 1500.0, 'max': 2300.0}, {'current': 2.832, 'min': 1500.0, 'max': 2300.0}, {'current': 3.546, 'min': 1500.0, 'max': 2300.0}, {'current': 2.828, 'min': 1500.0, 'max': 2300.0}, {'current': 2.793, 'min': 1500.0, 'max': 2300.0}, {'current': 3.442, 'min': 1500.0, 'max': 2300.0}, {'current': 2.752, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 2.754, 'min': 1500.0, 'max': 2300.0}, {'current': 1.534, 'min': 1500.0, 'max': 2300.0}, {'current': 1.543, 'min': 1500.0, 'max': 2300.0}, {'current': 1.54, 'min': 1500.0, 'max': 2300.0}, {'current': 1.535, 'min': 1500.0, 'max': 2300.0}, {'current': 1.834, 'min': 1500.0, 'max': 2300.0}, {'current': 1.536, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.498, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.536, 'min': 1500.0, 'max': 2300.0}, {'current': 1.534, 'min': 1500.0, 'max': 2300.0}, {'current': 1.537, 'min': 1500.0, 'max': 2300.0}, {'current': 1.799, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 2.753, 'min': 1500.0, 'max': 2300.0}, {'current': 3.418, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 3.551, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.753, 'min': 1500.0, 'max': 2300.0}, {'current': 2.753, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 2.75, 'min': 1500.0, 'max': 2300.0}, {'current': 3.446, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 3.45, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.796, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 1.798, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 2.724, 'min': 1500.0, 'max': 2300.0}, {'current': 2.757, 'min': 1500.0, 'max': 2300.0}, {'current': 2.76, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 3.44, 'min': 1500.0, 'max': 2300.0}, {'current': 1.489, 'min': 1500.0, 'max': 2300.0}, {'current': 1.495, 'min': 1500.0, 'max': 2300.0}, {'current': 1.795, 'min': 1500.0, 'max': 2300.0}, {'current': 1.494, 'min': 1500.0, 'max': 2300.0}, {'current': 1.798, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.499, 'min': 1500.0, 'max': 2300.0}, {'current': 1.504, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.496, 'min': 1500.0, 'max': 2300.0}, {'current': 1.497, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 2.759, 'min': 1500.0, 'max': 2300.0}, {'current': 3.455, 'min': 1500.0, 'max': 2300.0}, {'current': 2.756, 'min': 1500.0, 'max': 2300.0}, {'current': 2.755, 'min': 1500.0, 'max': 2300.0}], 'disk': {'/': {'total': 199.90234375, 'used': 66.85475158691406}}, 'gpu': 'NVIDIA A100 80GB PCIe', 'gpu_count': 3, 'gpu_devices': [{'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}], 'memory': {'total': 2003.8947677612305}}
2023-11-07 17:06:13,971 INFO    HandlerThread:377096 [system_monitor.py:probe():224] Finished collecting system info
2023-11-07 17:06:13,971 INFO    HandlerThread:377096 [system_monitor.py:probe():227] Publishing system info
2023-11-07 17:06:13,971 DEBUG   HandlerThread:377096 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2023-11-07 17:06:13,972 DEBUG   HandlerThread:377096 [system_info.py:_save_pip():68] Saving pip packages done
2023-11-07 17:06:13,972 DEBUG   HandlerThread:377096 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2023-11-07 17:06:14,767 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/requirements.txt
2023-11-07 17:06:14,768 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/conda-environment.yaml
2023-11-07 17:06:16,718 DEBUG   HandlerThread:377096 [system_info.py:_save_conda():87] Saving conda packages done
2023-11-07 17:06:16,721 INFO    HandlerThread:377096 [system_monitor.py:probe():229] Finished publishing system info
2023-11-07 17:06:16,723 DEBUG   SenderThread:377096 [sender.py:send():380] send: files
2023-11-07 17:06:16,723 INFO    SenderThread:377096 [sender.py:_save_file():1378] saving file wandb-metadata.json with policy now
2023-11-07 17:06:16,728 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: stop_status
2023-11-07 17:06:16,729 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: stop_status
2023-11-07 17:06:16,730 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: internal_messages
2023-11-07 17:06:16,766 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/conda-environment.yaml
2023-11-07 17:06:16,766 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/wandb-metadata.json
2023-11-07 17:06:17,027 DEBUG   SenderThread:377096 [sender.py:send():380] send: telemetry
2023-11-07 17:06:17,027 DEBUG   SenderThread:377096 [sender.py:send():380] send: config
2023-11-07 17:06:17,027 DEBUG   SenderThread:377096 [sender.py:send():380] send: metric
2023-11-07 17:06:17,027 DEBUG   SenderThread:377096 [sender.py:send():380] send: telemetry
2023-11-07 17:06:17,027 DEBUG   SenderThread:377096 [sender.py:send():380] send: metric
2023-11-07 17:06:17,027 WARNING SenderThread:377096 [sender.py:send_metric():1329] Seen metric with glob (shouldn't happen)
2023-11-07 17:06:17,318 INFO    wandb-upload_0:377096 [upload_job.py:push():131] Uploaded file /tmp/tmpq6j5anq0wandb/nv0ubt1t-wandb-metadata.json
2023-11-07 17:06:17,767 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/output.log
2023-11-07 17:06:17,790 DEBUG   SenderThread:377096 [sender.py:send():380] send: exit
2023-11-07 17:06:17,790 INFO    SenderThread:377096 [sender.py:send_exit():585] handling exit code: 1
2023-11-07 17:06:17,791 INFO    SenderThread:377096 [sender.py:send_exit():587] handling runtime: 3
2023-11-07 17:06:17,792 INFO    SenderThread:377096 [sender.py:_save_file():1378] saving file wandb-summary.json with policy end
2023-11-07 17:06:17,792 INFO    SenderThread:377096 [sender.py:send_exit():593] send defer
2023-11-07 17:06:17,792 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:17,793 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 0
2023-11-07 17:06:17,793 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:17,793 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 0
2023-11-07 17:06:17,793 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 1
2023-11-07 17:06:17,793 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:17,793 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 1
2023-11-07 17:06:17,793 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:17,793 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 1
2023-11-07 17:06:17,793 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 2
2023-11-07 17:06:17,793 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:17,793 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 2
2023-11-07 17:06:17,793 INFO    HandlerThread:377096 [system_monitor.py:finish():203] Stopping system monitor
2023-11-07 17:06:17,794 DEBUG   SystemMonitor:377096 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2023-11-07 17:06:17,795 INFO    HandlerThread:377096 [interfaces.py:finish():202] Joined cpu monitor
2023-11-07 17:06:17,795 DEBUG   SystemMonitor:377096 [system_monitor.py:_start():179] Finished system metrics aggregation loop
2023-11-07 17:06:17,795 INFO    HandlerThread:377096 [interfaces.py:finish():202] Joined disk monitor
2023-11-07 17:06:17,795 DEBUG   SystemMonitor:377096 [system_monitor.py:_start():183] Publishing last batch of metrics
2023-11-07 17:06:18,161 INFO    HandlerThread:377096 [interfaces.py:finish():202] Joined gpu monitor
2023-11-07 17:06:18,161 INFO    HandlerThread:377096 [interfaces.py:finish():202] Joined memory monitor
2023-11-07 17:06:18,161 INFO    HandlerThread:377096 [interfaces.py:finish():202] Joined network monitor
2023-11-07 17:06:18,162 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,162 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 2
2023-11-07 17:06:18,162 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 3
2023-11-07 17:06:18,162 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:18,162 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 3
2023-11-07 17:06:18,163 DEBUG   SenderThread:377096 [sender.py:send():380] send: stats
2023-11-07 17:06:18,163 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,163 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 3
2023-11-07 17:06:18,163 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 4
2023-11-07 17:06:18,163 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:18,164 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 4
2023-11-07 17:06:18,164 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,164 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 4
2023-11-07 17:06:18,164 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 5
2023-11-07 17:06:18,164 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:18,164 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 5
2023-11-07 17:06:18,164 DEBUG   SenderThread:377096 [sender.py:send():380] send: summary
2023-11-07 17:06:18,165 INFO    SenderThread:377096 [sender.py:_save_file():1378] saving file wandb-summary.json with policy end
2023-11-07 17:06:18,165 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,165 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 5
2023-11-07 17:06:18,165 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 6
2023-11-07 17:06:18,165 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:18,165 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 6
2023-11-07 17:06:18,165 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,165 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 6
2023-11-07 17:06:18,168 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: status_report
2023-11-07 17:06:18,401 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 7
2023-11-07 17:06:18,401 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:18,402 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 7
2023-11-07 17:06:18,402 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:18,402 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 7
2023-11-07 17:06:18,767 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/config.yaml
2023-11-07 17:06:18,767 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/wandb-summary.json
2023-11-07 17:06:18,791 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:19,044 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 8
2023-11-07 17:06:19,045 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:19,045 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:19,045 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 8
2023-11-07 17:06:19,045 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:19,045 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 8
2023-11-07 17:06:19,045 INFO    SenderThread:377096 [job_builder.py:build():281] Attempting to build job artifact
2023-11-07 17:06:19,046 INFO    SenderThread:377096 [job_builder.py:_get_source_type():393] is repo sourced job
2023-11-07 17:06:19,047 INFO    SenderThread:377096 [job_builder.py:build():369] adding wandb-job metadata file
2023-11-07 17:06:19,049 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 9
2023-11-07 17:06:19,049 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:19,049 DEBUG   SenderThread:377096 [sender.py:send():380] send: artifact
2023-11-07 17:06:19,050 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 9
2023-11-07 17:06:19,767 INFO    Thread-12 :377096 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/output.log
2023-11-07 17:06:19,792 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:19,953 INFO    SenderThread:377096 [sender.py:send_artifact():1456] sent artifact job-git_github.com_gianlucamacri_LongLoRA.git_supervised-fine-tune-qlora.py - {'id': 'QXJ0aWZhY3Q6NjMwOTM4NTQ4', 'state': 'COMMITTED', 'artifactSequence': {'id': 'QXJ0aWZhY3RDb2xsZWN0aW9uOjEwOTQ3NzUzMQ==', 'latestArtifact': {'id': 'QXJ0aWZhY3Q6NjMwOTQ0NTMw', 'versionIndex': 58}}}
2023-11-07 17:06:19,953 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:19,953 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 9
2023-11-07 17:06:19,953 INFO    SenderThread:377096 [dir_watcher.py:finish():358] shutting down directory watcher
2023-11-07 17:06:20,768 INFO    SenderThread:377096 [dir_watcher.py:finish():388] scan: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files
2023-11-07 17:06:20,768 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/config.yaml config.yaml
2023-11-07 17:06:20,768 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/requirements.txt requirements.txt
2023-11-07 17:06:20,769 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/conda-environment.yaml conda-environment.yaml
2023-11-07 17:06:20,770 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/wandb-metadata.json wandb-metadata.json
2023-11-07 17:06:20,771 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/output.log output.log
2023-11-07 17:06:20,771 INFO    SenderThread:377096 [dir_watcher.py:finish():402] scan save: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/wandb-summary.json wandb-summary.json
2023-11-07 17:06:20,771 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 10
2023-11-07 17:06:20,771 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:20,771 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:20,772 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 10
2023-11-07 17:06:20,780 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:20,780 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 10
2023-11-07 17:06:20,780 INFO    SenderThread:377096 [file_pusher.py:finish():175] shutting down file pusher
2023-11-07 17:06:20,792 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:20,793 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:21,213 INFO    wandb-upload_0:377096 [upload_job.py:push():131] Uploaded file /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/requirements.txt
2023-11-07 17:06:21,244 INFO    wandb-upload_1:377096 [upload_job.py:push():131] Uploaded file /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/config.yaml
2023-11-07 17:06:21,398 INFO    wandb-upload_2:377096 [upload_job.py:push():131] Uploaded file /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/conda-environment.yaml
2023-11-07 17:06:21,405 INFO    wandb-upload_3:377096 [upload_job.py:push():131] Uploaded file /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/output.log
2023-11-07 17:06:21,485 INFO    wandb-upload_4:377096 [upload_job.py:push():131] Uploaded file /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/files/wandb-summary.json
2023-11-07 17:06:21,686 INFO    Thread-11 (_thread_body):377096 [sender.py:transition_state():613] send defer: 11
2023-11-07 17:06:21,686 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:21,686 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 11
2023-11-07 17:06:21,687 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:21,687 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 11
2023-11-07 17:06:21,687 INFO    SenderThread:377096 [file_pusher.py:join():181] waiting for file pusher
2023-11-07 17:06:21,687 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 12
2023-11-07 17:06:21,687 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:21,687 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 12
2023-11-07 17:06:21,687 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:21,687 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 12
2023-11-07 17:06:21,687 INFO    SenderThread:377096 [file_stream.py:finish():595] file stream finish called
2023-11-07 17:06:21,793 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:21,870 INFO    SenderThread:377096 [file_stream.py:finish():599] file stream finish is done
2023-11-07 17:06:21,870 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 13
2023-11-07 17:06:21,870 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:21,870 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:21,870 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 13
2023-11-07 17:06:21,871 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:21,871 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 13
2023-11-07 17:06:21,871 INFO    SenderThread:377096 [sender.py:transition_state():613] send defer: 14
2023-11-07 17:06:21,871 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: defer
2023-11-07 17:06:21,871 INFO    HandlerThread:377096 [handler.py:handle_request_defer():172] handle defer: 14
2023-11-07 17:06:21,871 DEBUG   SenderThread:377096 [sender.py:send():380] send: final
2023-11-07 17:06:21,871 DEBUG   SenderThread:377096 [sender.py:send():380] send: footer
2023-11-07 17:06:21,871 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: defer
2023-11-07 17:06:21,871 INFO    SenderThread:377096 [sender.py:send_request_defer():609] handle sender defer: 14
2023-11-07 17:06:21,872 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:21,873 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: poll_exit
2023-11-07 17:06:21,873 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:21,873 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: poll_exit
2023-11-07 17:06:21,873 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: server_info
2023-11-07 17:06:21,874 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: server_info
2023-11-07 17:06:21,875 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: get_summary
2023-11-07 17:06:21,875 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: sampled_history
2023-11-07 17:06:21,876 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: internal_messages
2023-11-07 17:06:21,876 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: job_info
2023-11-07 17:06:22,034 DEBUG   SenderThread:377096 [sender.py:send_request():407] send_request: job_info
2023-11-07 17:06:22,035 INFO    MainThread:377096 [wandb_run.py:_footer_history_summary_info():3599] rendering history
2023-11-07 17:06:22,035 INFO    MainThread:377096 [wandb_run.py:_footer_history_summary_info():3631] rendering summary
2023-11-07 17:06:22,035 INFO    MainThread:377096 [wandb_run.py:_footer_sync_info():3558] logging synced files
2023-11-07 17:06:22,035 DEBUG   HandlerThread:377096 [handler.py:handle_request():146] handle_request: shutdown
2023-11-07 17:06:22,035 INFO    HandlerThread:377096 [handler.py:finish():866] shutting down handler
2023-11-07 17:06:22,876 INFO    WriterThread:377096 [datastore.py:close():294] close: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_170613-4kqyl9ik/run-4kqyl9ik.wandb
2023-11-07 17:06:23,035 INFO    SenderThread:377096 [sender.py:finish():1534] shutting down sender
2023-11-07 17:06:23,035 INFO    SenderThread:377096 [file_pusher.py:finish():175] shutting down file pusher
2023-11-07 17:06:23,035 INFO    SenderThread:377096 [file_pusher.py:join():181] waiting for file pusher
