2023-11-07 21:53:11,907 INFO    StreamThr :1339476 [internal.py:wandb_internal():86] W&B internal server running at pid: 1339476, started at: 2023-11-07 21:53:11.905834
2023-11-07 21:53:11,909 DEBUG   HandlerThread:1339476 [handler.py:handle_request():146] handle_request: status
2023-11-07 21:53:11,912 INFO    WriterThread:1339476 [datastore.py:open_for_write():85] open: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/run-nsx8fgn7.wandb
2023-11-07 21:53:11,913 DEBUG   SenderThread:1339476 [sender.py:send():380] send: header
2023-11-07 21:53:11,913 DEBUG   SenderThread:1339476 [sender.py:send():380] send: run
2023-11-07 21:53:12,417 INFO    SenderThread:1339476 [dir_watcher.py:__init__():211] watching files in: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/files
2023-11-07 21:53:12,417 INFO    SenderThread:1339476 [sender.py:_start_run_threads():1124] run started: nsx8fgn7 with start time 1699393991.90578
2023-11-07 21:53:12,427 DEBUG   HandlerThread:1339476 [handler.py:handle_request():146] handle_request: check_version
2023-11-07 21:53:12,427 DEBUG   SenderThread:1339476 [sender.py:send_request():407] send_request: check_version
2023-11-07 21:53:12,529 DEBUG   HandlerThread:1339476 [handler.py:handle_request():146] handle_request: run_start
2023-11-07 21:53:12,563 DEBUG   HandlerThread:1339476 [system_info.py:__init__():32] System info init
2023-11-07 21:53:12,563 DEBUG   HandlerThread:1339476 [system_info.py:__init__():47] System info init done
2023-11-07 21:53:12,563 INFO    HandlerThread:1339476 [system_monitor.py:start():194] Starting system monitor
2023-11-07 21:53:12,564 INFO    SystemMonitor:1339476 [system_monitor.py:_start():158] Starting system asset monitoring threads
2023-11-07 21:53:12,564 INFO    HandlerThread:1339476 [system_monitor.py:probe():214] Collecting system info
2023-11-07 21:53:12,565 INFO    SystemMonitor:1339476 [interfaces.py:start():190] Started cpu monitoring
2023-11-07 21:53:12,566 INFO    SystemMonitor:1339476 [interfaces.py:start():190] Started disk monitoring
2023-11-07 21:53:12,567 INFO    SystemMonitor:1339476 [interfaces.py:start():190] Started gpu monitoring
2023-11-07 21:53:12,568 INFO    SystemMonitor:1339476 [interfaces.py:start():190] Started memory monitoring
2023-11-07 21:53:12,568 INFO    SystemMonitor:1339476 [interfaces.py:start():190] Started network monitoring
2023-11-07 21:53:12,624 DEBUG   HandlerThread:1339476 [system_info.py:probe():196] Probing system
2023-11-07 21:53:12,626 DEBUG   HandlerThread:1339476 [system_info.py:_probe_git():181] Probing git
2023-11-07 21:53:12,635 DEBUG   HandlerThread:1339476 [system_info.py:_probe_git():189] Probing git done
2023-11-07 21:53:12,635 DEBUG   HandlerThread:1339476 [system_info.py:probe():244] Probing system done
2023-11-07 21:53:12,635 DEBUG   HandlerThread:1339476 [system_monitor.py:probe():223] {'os': 'Linux-5.4.0-166-generic-x86_64-with-glibc2.31', 'python': '3.11.5', 'heartbeatAt': '2023-11-07T21:53:12.624070', 'startedAt': '2023-11-07T21:53:11.900705', 'docker': None, 'cuda': None, 'args': ('--model_name_or_path', 'Yukang/LongAlpaca-7B', '--output_dir', '../../output/hdd_output/LongLoRA/test', '--model_max_length', '8192', '--use_flash_attn', 'False', '--low_rank_training', 'True', '--num_train_epochs', '30', '--per_device_train_batch_size', '2', '--gradient_accumulation_steps', '4', '--per_device_eval_batch_size', '1', '--load_best_model_at_end', 'True', '--evaluation_strategy', 'epoch', '--save_strategy', 'epoch', '--save_total_limit', '7', '--learning_rate', '2e-5', '--weight_decay', '0.0', '--logging_steps', '1', '--bf16', 'True', '--tf32', 'True', '--lr_scheduler_type', 'constant', '--deepspeed', 'ds_configs/stage2.json', '--hf_dataset', 'gianma/eurlexsum_ita_cleaned_8192_232', '--target_column', 'summary', '--max_prompt_token_count', '232', '--use_early_stopping', 'True', '--es_patience', '2', '--es_threshold', '0.05', '--use_quantization', 'True', '--prompts', "Di seguito c'Ã¨ un documento legislativo in italiano. Memorizza il documento legislativo, poi segui le istruzioni.\\nINIZIO DOCUMENTO.\\n{reference}\\nFINE DOCUMENTO.\\nScrivi un dossier riassuntivo del documento. Scrivi in italiano, non scrivere in inglese.", '--system_prompt', 'You are a helpful, respectful and honest assistant specialized in writing dossiers for legislative documents. Always answer as helpfully as possible, while being safe. Your answers should not include any false information with respect to the original document.'), 'state': 'running', 'program': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/supervised-fine-tune-qlora.py', 'codePathLocal': 'supervised-fine-tune-qlora.py', 'codePath': 'supervised-fine-tune-qlora.py', 'git': {'remote': 'git@github.com:gianlucamacri/LongLoRA.git', 'commit': '75716cdf32805cc55dd1ada0dcb50989b688d22b'}, 'email': 'gianluca18ma@gmail.com', 'root': '/home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA', 'host': 'donatello', 'username': 'gmacri', 'executable': '/home/gmacri/miniconda3/bin/python', 'cpu_count': 96, 'cpu_count_logical': 192, 'cpu_freq': {'current': 1593.9653697916665, 'min': 1500.0, 'max': 2300.0}, 'cpu_freq_per_core': [{'current': 1499.994, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.766, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.697, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.119, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.324, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.477, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.391, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.808, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.544, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.608, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.813, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.343, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.474, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.598, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.594, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.695, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.486, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.645, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.506, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.66, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.034, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.841, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.943, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.029, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.38, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.255, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.004, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.689, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.106, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.049, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.545, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.619, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.835, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.641, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.164, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.055, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.681, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.651, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.835, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.039, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.727, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.123, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.904, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.752, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.182, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.284, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.864, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.484, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.44, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.095, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.286, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.532, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.557, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.617, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.453, 'min': 1500.0, 'max': 2300.0}, {'current': 1502.259, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.255, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.06, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.723, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.257, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.452, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.221, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.476, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.504, 'min': 1500.0, 'max': 2300.0}, {'current': 1510.137, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.507, 'min': 1500.0, 'max': 2300.0}, {'current': 3569.295, 'min': 1500.0, 'max': 2300.0}, {'current': 2754.855, 'min': 1500.0, 'max': 2300.0}, {'current': 2759.638, 'min': 1500.0, 'max': 2300.0}, {'current': 2756.153, 'min': 1500.0, 'max': 2300.0}, {'current': 2711.232, 'min': 1500.0, 'max': 2300.0}, {'current': 2758.273, 'min': 1500.0, 'max': 2300.0}, {'current': 2758.188, 'min': 1500.0, 'max': 2300.0}, {'current': 2759.579, 'min': 1500.0, 'max': 2300.0}, {'current': 2756.294, 'min': 1500.0, 'max': 2300.0}, {'current': 2758.246, 'min': 1500.0, 'max': 2300.0}, {'current': 3448.899, 'min': 1500.0, 'max': 2300.0}, {'current': 2757.545, 'min': 1500.0, 'max': 2300.0}, {'current': 2598.071, 'min': 1500.0, 'max': 2300.0}, {'current': 1980.159, 'min': 1500.0, 'max': 2300.0}, {'current': 1988.465, 'min': 1500.0, 'max': 2300.0}, {'current': 1992.394, 'min': 1500.0, 'max': 2300.0}, {'current': 2027.738, 'min': 1500.0, 'max': 2300.0}, {'current': 1983.299, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.446, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.654, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.888, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.305, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.645, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.013, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.977, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.346, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.279, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.938, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.446, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.975, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.802, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.981, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.777, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.941, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.609, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.687, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.546, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.067, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.322, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.526, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.192, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.081, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.466, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.979, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.583, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.1, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.839, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.431, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.37, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.848, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.62, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.995, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.381, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.23, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.197, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.898, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.651, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.107, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.574, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.0, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.576, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.303, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.734, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.761, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.325, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.338, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.638, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.476, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.152, 'min': 1500.0, 'max': 2300.0}, {'current': 1376.414, 'min': 1500.0, 'max': 2300.0}, {'current': 1377.576, 'min': 1500.0, 'max': 2300.0}, {'current': 1394.19, 'min': 1500.0, 'max': 2300.0}, {'current': 1376.469, 'min': 1500.0, 'max': 2300.0}, {'current': 1377.715, 'min': 1500.0, 'max': 2300.0}, {'current': 1375.31, 'min': 1500.0, 'max': 2300.0}, {'current': 1375.311, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.725, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.705, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.887, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.05, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.61, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.844, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.225, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.16, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.504, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.21, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.013, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.634, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.334, 'min': 1500.0, 'max': 2300.0}, {'current': 1507.401, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.041, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.075, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.528, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.627, 'min': 1500.0, 'max': 2300.0}, {'current': 1498.152, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.188, 'min': 1500.0, 'max': 2300.0}, {'current': 3497.916, 'min': 1500.0, 'max': 2300.0}, {'current': 2756.033, 'min': 1500.0, 'max': 2300.0}, {'current': 2757.657, 'min': 1500.0, 'max': 2300.0}, {'current': 2757.227, 'min': 1500.0, 'max': 2300.0}, {'current': 2750.71, 'min': 1500.0, 'max': 2300.0}, {'current': 2757.655, 'min': 1500.0, 'max': 2300.0}, {'current': 2753.475, 'min': 1500.0, 'max': 2300.0}, {'current': 2758.644, 'min': 1500.0, 'max': 2300.0}, {'current': 2750.852, 'min': 1500.0, 'max': 2300.0}, {'current': 2827.776, 'min': 1500.0, 'max': 2300.0}, {'current': 3567.715, 'min': 1500.0, 'max': 2300.0}, {'current': 2758.61, 'min': 1500.0, 'max': 2300.0}, {'current': 3519.375, 'min': 1500.0, 'max': 2300.0}, {'current': 2006.849, 'min': 1500.0, 'max': 2300.0}, {'current': 2002.507, 'min': 1500.0, 'max': 2300.0}, {'current': 1976.175, 'min': 1500.0, 'max': 2300.0}, {'current': 1975.208, 'min': 1500.0, 'max': 2300.0}, {'current': 1993.916, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.203, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.712, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.646, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.3, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.247, 'min': 1500.0, 'max': 2300.0}, {'current': 1494.625, 'min': 1500.0, 'max': 2300.0}, {'current': 1495.681, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.52, 'min': 1500.0, 'max': 2300.0}, {'current': 1494.585, 'min': 1500.0, 'max': 2300.0}, {'current': 1497.2, 'min': 1500.0, 'max': 2300.0}, {'current': 1496.128, 'min': 1500.0, 'max': 2300.0}, {'current': 1499.066, 'min': 1500.0, 'max': 2300.0}], 'disk': {'/': {'total': 199.90234375, 'used': 66.85679244995117}}, 'gpu': 'NVIDIA A100 80GB PCIe', 'gpu_count': 3, 'gpu_devices': [{'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}, {'name': 'NVIDIA A100 80GB PCIe', 'memory_total': 85899345920}], 'memory': {'total': 2003.8947677612305}}
2023-11-07 21:53:12,635 INFO    HandlerThread:1339476 [system_monitor.py:probe():224] Finished collecting system info
2023-11-07 21:53:12,635 INFO    HandlerThread:1339476 [system_monitor.py:probe():227] Publishing system info
2023-11-07 21:53:12,635 DEBUG   HandlerThread:1339476 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2023-11-07 21:53:12,636 DEBUG   HandlerThread:1339476 [system_info.py:_save_pip():68] Saving pip packages done
2023-11-07 21:53:12,636 DEBUG   HandlerThread:1339476 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2023-11-07 21:53:13,419 INFO    Thread-12 :1339476 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/files/requirements.txt
2023-11-07 21:53:13,419 INFO    Thread-12 :1339476 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/files/conda-environment.yaml
2023-11-07 21:53:14,245 DEBUG   HandlerThread:1339476 [system_info.py:_save_conda():87] Saving conda packages done
2023-11-07 21:53:14,248 INFO    HandlerThread:1339476 [system_monitor.py:probe():229] Finished publishing system info
2023-11-07 21:53:14,250 DEBUG   SenderThread:1339476 [sender.py:send():380] send: files
2023-11-07 21:53:14,250 INFO    SenderThread:1339476 [sender.py:_save_file():1380] saving file wandb-metadata.json with policy now
2023-11-07 21:53:14,418 INFO    Thread-12 :1339476 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/files/conda-environment.yaml
2023-11-07 21:53:14,418 INFO    Thread-12 :1339476 [dir_watcher.py:_on_file_created():271] file/dir created: /home/gmacri/tirocinioCameraSummarization/LongLora_fork/LongLoRA/wandb/run-20231107_215311-nsx8fgn7/files/wandb-metadata.json
2023-11-07 21:53:14,576 INFO    cpu       :1339476 [interfaces.py:monitor():140] Process cpu has exited.
2023-11-07 21:53:14,577 DEBUG   SystemMonitor:1339476 [system_monitor.py:_start():172] Starting system metrics aggregation loop
2023-11-07 21:53:14,578 DEBUG   SystemMonitor:1339476 [system_monitor.py:_start():179] Finished system metrics aggregation loop
2023-11-07 21:53:14,578 DEBUG   SystemMonitor:1339476 [system_monitor.py:_start():183] Publishing last batch of metrics
2023-11-07 21:53:14,582 DEBUG   SenderThread:1339476 [sender.py:send():380] send: stats
2023-11-07 21:53:14,582 INFO    memory    :1339476 [interfaces.py:monitor():140] Process proc.memory.rssMB has exited.
2023-11-07 21:53:14,841 INFO    wandb-upload_0:1339476 [upload_job.py:push():131] Uploaded file /tmp/tmpuu8ypk14wandb/7jvl13il-wandb-metadata.json
2023-11-07 21:53:14,842 INFO    MainThread:1339476 [internal.py:handle_exit():76] Internal process exited
